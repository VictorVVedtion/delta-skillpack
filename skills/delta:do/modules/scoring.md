# 加权评分系统 (Weighted Scoring System)

## 概述

任务复杂度采用 6 维度加权评分系统，总分 100 分。此系统取代传统的关键词匹配，提供量化、可追溯的复杂度评估。

---

## 评分维度

### 1. 范围广度 (Scope Breadth) - 25%

评估任务影响的文件和模块数量。

| 分数 | 标准 | 信号 |
|------|------|------|
| 0-5 | 单文件修改 | 明确指定单个文件 |
| 6-12 | 2-5 个文件 | 一个模块内的修改 |
| 13-18 | 6-10 个文件 | 跨模块修改 |
| 19-25 | >10 个文件 | 系统级变更 |

**评估方法**：
- 任务描述中的文件引用
- 功能涉及的模块数量
- 关键词: `所有`, `全部`, `整个`, `系统`, `全局`

---

### 2. 依赖复杂度 (Dependency Complexity) - 20%

评估模块间依赖关系和集成难度。

| 分数 | 标准 | 信号 |
|------|------|------|
| 0-5 | 无依赖/独立功能 | 纯工具函数、静态内容 |
| 6-10 | 单向依赖 | 调用现有 API |
| 11-15 | 双向依赖 | 需要修改接口 |
| 16-20 | 复杂依赖图 | 多模块相互调用 |

**评估方法**：
- 是否涉及 API 变更
- 是否需要数据库迁移
- 关键词: `集成`, `接口`, `API`, `数据库`, `schema`

---

### 3. 技术深度 (Technical Depth) - 20%

评估技术难度和新技术学习曲线。

| 分数 | 标准 | 信号 |
|------|------|------|
| 0-5 | 基础操作 | 修复拼写、添加注释 |
| 6-10 | 常规开发 | 标准 CRUD、简单逻辑 |
| 11-15 | 中等难度 | 算法优化、复杂业务逻辑 |
| 16-20 | 高级技术 | 新框架、架构设计、性能优化 |

**评估方法**：
- 是否涉及新技术栈
- 算法/架构复杂度
- 关键词: `优化`, `性能`, `架构`, `重构`, `算法`

---

### 4. 风险等级 (Risk Level) - 15%

评估变更的破坏性和可逆性。

| 分数 | 标准 | 信号 |
|------|------|------|
| 0-3 | 可逆/低风险 | 添加新功能（不影响现有） |
| 4-7 | 中等风险 | 修改现有功能 |
| 8-11 | 较高风险 | 删除/重命名、数据变更 |
| 12-15 | 高风险 | 系统核心、不可逆操作 |

**评估方法**：
- 是否影响生产环境
- 是否涉及数据删除
- 关键词: `删除`, `迁移`, `核心`, `生产`, `关键`

---

### 5. 时间估算 (Time Estimation) - 10%

基于任务规模的时间预估。

| 分数 | 标准 | 信号 |
|------|------|------|
| 0-2 | <30 分钟 | 单步操作 |
| 3-5 | 30分钟-2小时 | 简单功能 |
| 6-8 | 2-8 小时 | 中等功能 |
| 9-10 | >8 小时 | 大型功能 |

**评估方法**：
- 任务描述的详细程度
- 子任务数量估算
- 词数和复杂度组合

---

### 6. UI 复杂度 (UI Complexity) - 10%

评估界面和交互复杂度。

| 分数 | 标准 | 信号 |
|------|------|------|
| 0-2 | 无 UI | 纯后端/脚本 |
| 3-5 | 简单 UI | 单组件、简单样式 |
| 6-8 | 中等 UI | 多组件、响应式 |
| 9-10 | 复杂 UI | 动画、复杂交互、设计系统 |

**评估方法**：
- UI 相关关键词密度
- 交互描述复杂度
- 关键词: `ui`, `页面`, `组件`, `样式`, `动画`, `交互`

---

## 评分流程

### Step 1: 初始化评分卡

```
评分卡 = {
  scope: 0,       // 范围广度 (0-25)
  dependency: 0,  // 依赖复杂度 (0-20)
  technical: 0,   // 技术深度 (0-20)
  risk: 0,        // 风险等级 (0-15)
  time: 0,        // 时间估算 (0-10)
  ui: 0           // UI 复杂度 (0-10)
}
```

### Step 2: 逐维度评分

对每个维度：
1. 提取任务描述中的相关信号
2. 匹配评分标准
3. 综合判断给出分数

### Step 3: 计算总分

```
总分 = scope + dependency + technical + risk + time + ui
```

### Step 4: 输出评分报告

```
📊 复杂度评分: {总分}/100
┌────────────────────────────────────────┐
│ 范围广度:    {条形图} {scope}/25       │
│ 依赖复杂度:  {条形图} {dependency}/20  │
│ 技术深度:    {条形图} {technical}/20   │
│ 风险等级:    {条形图} {risk}/15        │
│ 时间估算:    {条形图} {time}/10        │
│ UI 复杂度:   {条形图} {ui}/10          │
└────────────────────────────────────────┘
```

---

## 条形图生成规则

```
百分比 = 当前分数 / 该维度满分 * 100
填充数 = round(百分比 / 10)
空白数 = 10 - 填充数
条形图 = "█" * 填充数 + "░" * 空白数
```

示例：
- 18/25 → 72% → `███████░░░`
- 12/20 → 60% → `██████░░░░`
- 6/15 → 40% → `████░░░░░░`

---

## 关键词快速信号表

### 复杂度降低信号 (总分 -5~-15)

| 关键词 | 影响 |
|--------|------|
| `typo`, `拼写`, `comment`, `注释` | -10 |
| `rename`, `重命名` | -8 |
| `readme`, `文档` | -5 |
| `简单`, `快速`, `小改` | -5 |

### 复杂度提升信号 (总分 +10~+30)

| 关键词 | 影响 |
|--------|------|
| `系统`, `架构`, `architecture` | +20 |
| `完整`, `complete`, `全面` | +15 |
| `重构`, `refactor` | +15 |
| `从零`, `from scratch` | +25 |
| `多模块`, `multi-module` | +15 |

### UI 信号 (强制 UI 路由检查)

| 关键词 | 动作 |
|--------|------|
| `ui`, `ux`, `界面`, `组件` | 检查 UI 路由 |
| `页面`, `page`, `布局`, `layout` | 检查 UI 路由 |
| `样式`, `css`, `前端` | 检查 UI 路由 |

---

## 使用示例

### 示例 1: 简单任务

**任务**: "fix typo in README"

| 维度 | 分数 | 理由 |
|------|------|------|
| 范围广度 | 2 | 单文件 |
| 依赖复杂度 | 0 | 无依赖 |
| 技术深度 | 1 | 基础操作 |
| 风险等级 | 1 | 可逆 |
| 时间估算 | 1 | <30分钟 |
| UI 复杂度 | 0 | 无 UI |
| **总分** | **5** | DIRECT |

### 示例 2: 中等任务

**任务**: "add user authentication with JWT"

| 维度 | 分数 | 理由 |
|------|------|------|
| 范围广度 | 12 | 3-5 个文件 |
| 依赖复杂度 | 10 | 需要 API 集成 |
| 技术深度 | 10 | 常规开发 |
| 风险等级 | 5 | 中等风险 |
| 时间估算 | 5 | 1-2 小时 |
| UI 复杂度 | 3 | 简单登录表单 |
| **总分** | **45** | PLANNED |

### 示例 3: 复杂任务

**任务**: "build complete authentication system with OAuth, MFA, and session management"

| 维度 | 分数 | 理由 |
|------|------|------|
| 范围广度 | 20 | 多模块 |
| 依赖复杂度 | 16 | 复杂依赖 |
| 技术深度 | 15 | 中等难度 |
| 风险等级 | 10 | 较高风险 |
| 时间估算 | 8 | >4 小时 |
| UI 复杂度 | 6 | 多个 UI 组件 |
| **总分** | **75** | ARCHITECT |
