---
name: delta:do
description: 统一任务入口 - 智能分析任务复杂度，自动路由到最优执行路径，支持中断恢复
version: 3.0.0
---

# delta:do - 智能任务执行器 v3.0.0

## 核心法则

1. **量化决策** - 6 维度加权评分，决策可追溯
2. **中断可恢复** - 检查点机制，长任务安全中断
3. **质量保证** - 两阶段审查，规格合规 + 代码质量
4. **立即行动** - 不只解释，真正执行

---

## 调用方式

```bash
/do <任务描述>                # 智能路由
/do <任务描述> --quick        # 强制 DIRECT
/do <任务描述> --deep         # 强制 RALPH
/do <任务描述> --explain      # 仅显示评分和路由
/do --resume                  # 从检查点恢复
/do --resume <task_id>        # 恢复指定任务
/do --list-checkpoints        # 查看可恢复任务
```

---

## 路由决策

基于 `modules/scoring.md` 的 6 维度评分（总分 100）：

| 总分 | 路由 | 阶段 | 核心原则 |
|------|------|------|----------|
| 0-20 | **DIRECT** | 1 | 立即行动 |
| 21-45 | **PLANNED** | 3 | 计划先行 |
| 46-70 | **RALPH** | 4 | 分而治之 |
| 71-100 | **ARCHITECT** | 5 | 架构优先 |
| UI 信号 | **UI_FLOW** | 3 | 用户至上 |

详细路由逻辑见 `modules/routing.md`

---

## 执行路径

### DIRECT (0-20分)
```
Phase 1 (100%): 直接执行
```

### PLANNED (21-45分)
```
Phase 1 (30%): 规划
Phase 2 (60%): 实现
Phase 3 (100%): 两阶段审查
```

### RALPH (46-70分)
```
Phase 1 (20%): 深度分析
Phase 2 (40%): 规划
Phase 3 (75%): 执行子任务
Phase 4 (100%): 综合审查
```

### ARCHITECT (71-100分)
```
Phase 1 (15%): 架构分析
Phase 2 (30%): 架构设计
Phase 3 (50%): 实施规划
Phase 4 (80%): 分阶段实施
Phase 5 (100%): 验收审查
```

### UI_FLOW (UI信号)
```
Phase 1 (30%): UI 设计
Phase 2 (60%): 实现
Phase 3 (100%): 预览验证
```

---

## 模块引用

| 模块 | 功能 |
|------|------|
| `modules/scoring.md` | 6 维度加权评分系统 |
| `modules/routing.md` | 路由决策矩阵 |
| `modules/checkpoint.md` | 检查点与恢复机制 |
| `modules/recovery.md` | 错误处理与恢复策略 |
| `modules/review.md` | 两阶段审查系统 |

---

## 输出管理

```
.skillpack/
├── current/
│   ├── checkpoint.json       # 检查点
│   ├── 1_*.md               # 阶段输出
│   └── error.log            # 错误日志
└── history/<timestamp>/      # 历史记录
```

---

## 阶段提示格式

每阶段开始时输出：

```
════════════════════════════════════════════════════════════
📍 Phase {N}/{TOTAL}: {阶段名称} | {路由} 路由
════════════════════════════════════════════════════════════
进度: {进度条} {百分比}%

📊 复杂度评分: {总分}/100
┌────────────────────────────────────────┐
│ 范围广度:    {条形图} {score}/25       │
│ 依赖复杂度:  {条形图} {score}/20       │
│ 技术深度:    {条形图} {score}/20       │
│ 风险等级:    {条形图} {score}/15       │
│ 时间估算:    {条形图} {score}/10       │
│ UI 复杂度:   {条形图} {score}/10       │
└────────────────────────────────────────┘
────────────────────────────────────────────────────────────
```

---

## 示例

```bash
/do "fix typo"                    # → DIRECT (5分)
/do "add user auth"               # → PLANNED (35分)
/do "build complete CMS"          # → RALPH (58分)
/do "design new architecture"     # → ARCHITECT (82分)
/do "创建登录页面"                 # → UI_FLOW
```

---

## 执行指令

详细执行指令见 `CLAUDE.md`
